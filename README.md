# ğŸ›’ E-Commerce Backend API

## ï¿½ï¿½ Tá»•ng Quan

ÄÃ¢y lÃ  backend API cho há»‡ thá»‘ng e-commerce Ä‘Æ°á»£c xÃ¢y dá»±ng báº±ng Node.js, Express.js vÃ  Prisma ORM. Há»‡ thá»‘ng cung cáº¥p cÃ¡c API endpoints cho quáº£n lÃ½ sáº£n pháº©m, Ä‘Æ¡n hÃ ng, ngÆ°á»i dÃ¹ng vÃ  xÃ¡c thá»±c báº£o máº­t.

## ï¿½ï¿½ TÃ­nh NÄƒng ÄÃ£ HoÃ n ThÃ nh

### âœ… Database & ORM
- **Prisma ORM** - Quáº£n lÃ½ database vá»›i type safety
- **MySQL Database** - CÆ¡ sá»Ÿ dá»¯ liá»‡u chÃ­nh
- **Database Schema** - 20+ báº£ng vá»›i quan há»‡ Ä‘áº§y Ä‘á»§
- **Migrations** - Quáº£n lÃ½ thay Ä‘á»•i database
- **Seed Data** - Dá»¯ liá»‡u máº«u cho development

### âœ… Authentication & Security
- **JWT Authentication** - XÃ¡c thá»±c báº±ng JSON Web Token
- **Password Hashing** - MÃ£ hÃ³a máº­t kháº©u vá»›i bcrypt
- **Role-based Access Control** - PhÃ¢n quyá»n ADMIN/STAFF
- **Rate Limiting** - Giá»›i háº¡n sá»‘ request
- **CORS Protection** - Báº£o vá»‡ cross-origin
- **Security Headers** - Helmet middleware
- **Input Validation** - Kiá»ƒm tra dá»¯ liá»‡u Ä‘áº§u vÃ o

### âœ… API Endpoints
- **Health Check** - Kiá»ƒm tra tráº¡ng thÃ¡i server
- **Database Test** - Kiá»ƒm tra káº¿t ná»‘i database
- **Authentication** - Login, logout, profile
- **Error Handling** - Xá»­ lÃ½ lá»—i toÃ n diá»‡n
- **404 Handler** - Xá»­ lÃ½ route khÃ´ng tá»“n táº¡i

## ğŸ—ï¸ Cáº¥u TrÃºc Project
# ğŸ›’ E-Commerce Backend API

## ï¿½ï¿½ Tá»•ng Quan

ÄÃ¢y lÃ  backend API cho há»‡ thá»‘ng e-commerce Ä‘Æ°á»£c xÃ¢y dá»±ng báº±ng Node.js, Express.js vÃ  Prisma ORM. Há»‡ thá»‘ng cung cáº¥p cÃ¡c API endpoints cho quáº£n lÃ½ sáº£n pháº©m, Ä‘Æ¡n hÃ ng, ngÆ°á»i dÃ¹ng vÃ  xÃ¡c thá»±c báº£o máº­t.

## ï¿½ï¿½ TÃ­nh NÄƒng ÄÃ£ HoÃ n ThÃ nh

### âœ… Database & ORM
- **Prisma ORM** - Quáº£n lÃ½ database vá»›i type safety
- **MySQL Database** - CÆ¡ sá»Ÿ dá»¯ liá»‡u chÃ­nh
- **Database Schema** - 20+ báº£ng vá»›i quan há»‡ Ä‘áº§y Ä‘á»§
- **Migrations** - Quáº£n lÃ½ thay Ä‘á»•i database
- **Seed Data** - Dá»¯ liá»‡u máº«u cho development

### âœ… Authentication & Security
- **JWT Authentication** - XÃ¡c thá»±c báº±ng JSON Web Token
- **Password Hashing** - MÃ£ hÃ³a máº­t kháº©u vá»›i bcrypt
- **Role-based Access Control** - PhÃ¢n quyá»n ADMIN/STAFF
- **Rate Limiting** - Giá»›i háº¡n sá»‘ request
- **CORS Protection** - Báº£o vá»‡ cross-origin
- **Security Headers** - Helmet middleware
- **Input Validation** - Kiá»ƒm tra dá»¯ liá»‡u Ä‘áº§u vÃ o

### âœ… API Endpoints
- **Health Check** - Kiá»ƒm tra tráº¡ng thÃ¡i server
- **Database Test** - Kiá»ƒm tra káº¿t ná»‘i database
- **Authentication** - Login, logout, profile
- **Error Handling** - Xá»­ lÃ½ lá»—i toÃ n diá»‡n
- **404 Handler** - Xá»­ lÃ½ route khÃ´ng tá»“n táº¡i

## ğŸ—ï¸ Cáº¥u TrÃºc Project
# ğŸ›’ E-Commerce Backend API

## ï¿½ï¿½ Tá»•ng Quan

ÄÃ¢y lÃ  backend API cho há»‡ thá»‘ng e-commerce Ä‘Æ°á»£c xÃ¢y dá»±ng báº±ng Node.js, Express.js vÃ  Prisma ORM. Há»‡ thá»‘ng cung cáº¥p cÃ¡c API endpoints cho quáº£n lÃ½ sáº£n pháº©m, Ä‘Æ¡n hÃ ng, ngÆ°á»i dÃ¹ng vÃ  xÃ¡c thá»±c báº£o máº­t.

## ï¿½ï¿½ TÃ­nh NÄƒng ÄÃ£ HoÃ n ThÃ nh

### âœ… Database & ORM
- **Prisma ORM** - Quáº£n lÃ½ database vá»›i type safety
- **MySQL Database** - CÆ¡ sá»Ÿ dá»¯ liá»‡u chÃ­nh
- **Database Schema** - 20+ báº£ng vá»›i quan há»‡ Ä‘áº§y Ä‘á»§
- **Migrations** - Quáº£n lÃ½ thay Ä‘á»•i database
- **Seed Data** - Dá»¯ liá»‡u máº«u cho development

### âœ… Authentication & Security
- **JWT Authentication** - XÃ¡c thá»±c báº±ng JSON Web Token
- **Password Hashing** - MÃ£ hÃ³a máº­t kháº©u vá»›i bcrypt
- **Role-based Access Control** - PhÃ¢n quyá»n ADMIN/STAFF
- **Rate Limiting** - Giá»›i háº¡n sá»‘ request
- **CORS Protection** - Báº£o vá»‡ cross-origin
- **Security Headers** - Helmet middleware
- **Input Validation** - Kiá»ƒm tra dá»¯ liá»‡u Ä‘áº§u vÃ o

### âœ… API Endpoints
- **Health Check** - Kiá»ƒm tra tráº¡ng thÃ¡i server
- **Database Test** - Kiá»ƒm tra káº¿t ná»‘i database
- **Authentication** - Login, logout, profile
- **Error Handling** - Xá»­ lÃ½ lá»—i toÃ n diá»‡n
- **404 Handler** - Xá»­ lÃ½ route khÃ´ng tá»“n táº¡i

## ğŸ—ï¸ Cáº¥u TrÃºc Project
# ğŸ›’ E-Commerce Backend API

## ï¿½ï¿½ Tá»•ng Quan

ÄÃ¢y lÃ  backend API cho há»‡ thá»‘ng e-commerce Ä‘Æ°á»£c xÃ¢y dá»±ng báº±ng Node.js, Express.js vÃ  Prisma ORM. Há»‡ thá»‘ng cung cáº¥p cÃ¡c API endpoints cho quáº£n lÃ½ sáº£n pháº©m, Ä‘Æ¡n hÃ ng, ngÆ°á»i dÃ¹ng vÃ  xÃ¡c thá»±c báº£o máº­t.

## ï¿½ï¿½ TÃ­nh NÄƒng ÄÃ£ HoÃ n ThÃ nh

### âœ… Database & ORM
- **Prisma ORM** - Quáº£n lÃ½ database vá»›i type safety
- **MySQL Database** - CÆ¡ sá»Ÿ dá»¯ liá»‡u chÃ­nh
- **Database Schema** - 20+ báº£ng vá»›i quan há»‡ Ä‘áº§y Ä‘á»§
- **Migrations** - Quáº£n lÃ½ thay Ä‘á»•i database
- **Seed Data** - Dá»¯ liá»‡u máº«u cho development

### âœ… Authentication & Security
- **JWT Authentication** - XÃ¡c thá»±c báº±ng JSON Web Token
- **Password Hashing** - MÃ£ hÃ³a máº­t kháº©u vá»›i bcrypt
- **Role-based Access Control** - PhÃ¢n quyá»n ADMIN/STAFF
- **Rate Limiting** - Giá»›i háº¡n sá»‘ request
- **CORS Protection** - Báº£o vá»‡ cross-origin
- **Security Headers** - Helmet middleware
- **Input Validation** - Kiá»ƒm tra dá»¯ liá»‡u Ä‘áº§u vÃ o

### âœ… API Endpoints
- **Health Check** - Kiá»ƒm tra tráº¡ng thÃ¡i server
- **Database Test** - Kiá»ƒm tra káº¿t ná»‘i database
- **Authentication** - Login, logout, profile
- **Error Handling** - Xá»­ lÃ½ lá»—i toÃ n diá»‡n
- **404 Handler** - Xá»­ lÃ½ route khÃ´ng tá»“n táº¡i

## ğŸ—ï¸ Cáº¥u TrÃºc Project
backend/
â”œâ”€â”€ config/ # Cáº¥u hÃ¬nh
â”‚ â”œâ”€â”€ jwt.js # JWT configuration
â”‚ â”œâ”€â”€ database.js # Database config
â”‚ â””â”€â”€ cloudinary.js # Cloudinary config
â”œâ”€â”€ controller/ # Controllers
â”‚ â””â”€â”€ authController.js # Authentication controller
â”œâ”€â”€ middleware/ # Middleware
â”‚ â””â”€â”€ auth.js # Authentication middleware
â”œâ”€â”€ routes/ # API Routes
â”‚ â””â”€â”€ authRoutes.js # Authentication routes
â”œâ”€â”€ prisma/ # Prisma ORM
â”‚ â”œâ”€â”€ schema.prisma # Database schema
â”‚ â”œâ”€â”€ seed.js # Seed data
â”‚ â””â”€â”€ migrations/ # Database migrations
â”œâ”€â”€ utils/ # Utility functions
â”œâ”€â”€ services/ # Business logic
â”œâ”€â”€ validations/ # Input validation
â”œâ”€â”€ server.js # Main server file
â”œâ”€â”€ package.json # Dependencies
â””â”€â”€ .env # Environment variables


## ğŸ› ï¸ CÃ i Äáº·t & Cháº¡y

### 1. CÃ i Äáº·t Dependencies

```bash
npm install
```

### 2. Cáº¥u HÃ¬nh Environment

Táº¡o file `.env` trong thÆ° má»¥c `backend`:

```env
# Database
DATABASE_URL="mysql://root:password@localhost:3306/ecommerce_db"

# JWT
JWT_SECRET=your-super-secret-jwt-key-change-in-production-123456789
JWT_EXPIRES_IN=24h
JWT_REFRESH_EXPIRES_IN=7d

# Server
PORT=5000
NODE_ENV=development

# Frontend
FRONTEND_URL=http://localhost:3000
```

### 3. Setup Database

```bash
# Generate Prisma client
npx prisma generate

# Run migrations
npx prisma migrate dev

# Seed database
npm run seed
```

### 4. Cháº¡y Server

```bash
# Development mode
npm run dev

# Production mode
npm start
```

## ğŸ“š API Documentation

### Base URL
http://localhost:5000/api


### Authentication Endpoints

#### POST /auth/login
ÄÄƒng nháº­p admin

**Request:**
```json
{
  "email": "admin@ecommerce.com",
  "password": "admin123"
}
```

**Response:**
```json
{
  "success": true,
  "message": "ÄÄƒng nháº­p thÃ nh cÃ´ng",
  "data": {
    "user": {
      "id": 1,
      "email": "admin@ecommerce.com",
      "firstName": "Admin",
      "lastName": "Admin",
      "role": "ADMIN",
      "isActive": true
    },
    "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
  }
}
```

#### GET /auth/profile
Láº¥y thÃ´ng tin profile (cáº§n token)

**Headers:**
Authorization: Bearer YOUR_TOKEN_HERE

**Response:**
```json
{
  "success": true,
  "message": "ÄÄƒng xuáº¥t thÃ nh cÃ´ng"
}
```

### System Endpoints

#### GET /health
Kiá»ƒm tra tráº¡ng thÃ¡i server

**Response:**
```json
{
  "success": true,
  "message": "Server is running",
  "timestamp": "2025-09-12T02:39:14.412Z"
}
```

#### GET /test-db
Kiá»ƒm tra káº¿t ná»‘i database

**Response:**
```json
{
  "success": true,
  "message": "Database connected successfully"
}
```

## ğŸ§ª Testing

### Cháº¡y Test Suite

```bash
# Test toÃ n bá»™ há»‡ thá»‘ng
node test-auth.js
```

### Test Manual vá»›i cURL

```bash
# Health check
curl http://localhost:5000/api/health

# Database test
curl http://localhost:5000/api/test-db

# Login
curl -X POST http://localhost:5000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"admin@ecommerce.com","password":"admin123"}'

# Profile (thay YOUR_TOKEN báº±ng token thá»±c)
curl http://localhost:5000/api/auth/profile \
  -H "Authorization: Bearer YOUR_TOKEN"
```

## ï¿½ï¿½ Báº£o Máº­t

### JWT Token
- **Access Token**: Háº¿t háº¡n sau 24h
- **Refresh Token**: Háº¿t háº¡n sau 7 ngÃ y
- **Algorithm**: HS256

### Rate Limiting
- **Window**: 15 phÃºt
- **Max Requests**: 100 requests per window
- **Message**: "QuÃ¡ nhiá»u requests, vui lÃ²ng thá»­ láº¡i sau"

### Password Security
- **Hashing**: bcrypt vá»›i salt rounds = 10
- **Validation**: Tá»‘i thiá»ƒu 6 kÃ½ tá»±

## ğŸ“Š Database Schema

### CÃ¡c Báº£ng ChÃ­nh

#### Admin & Users
- `admin_users` - Quáº£n trá»‹ viÃªn
- `users` - KhÃ¡ch hÃ ng
- `otp_verifications` - XÃ¡c thá»±c OTP
- `password_resets` - Reset máº­t kháº©u

#### Products & Categories
- `categories` - Danh má»¥c sáº£n pháº©m
- `brands` - ThÆ°Æ¡ng hiá»‡u
- `products` - Sáº£n pháº©m
- `product_specifications` - ThÃ´ng sá»‘ ká»¹ thuáº­t
- `product_images` - HÃ¬nh áº£nh sáº£n pháº©m
- `product_variants` - Biáº¿n thá»ƒ sáº£n pháº©m

#### Orders & Payments
- `orders` - ÄÆ¡n hÃ ng
- `order_items` - Chi tiáº¿t Ä‘Æ¡n hÃ ng
- `payments` - Thanh toÃ¡n
- `coupons` - MÃ£ giáº£m giÃ¡
- `coupon_usage` - Lá»‹ch sá»­ sá»­ dá»¥ng coupon

#### User Experience
- `shopping_cart` - Giá» hÃ ng
- `wishlist` - Danh sÃ¡ch yÃªu thÃ­ch
- `product_comments` - BÃ¬nh luáº­n
- `product_reviews` - ÄÃ¡nh giÃ¡
- `notifications` - ThÃ´ng bÃ¡o

## ï¿½ï¿½ Deployment

### Environment Variables

```env
# Production
NODE_ENV=production
PORT=5000
DATABASE_URL="mysql://user:password@host:port/database"
JWT_SECRET="your-super-secret-production-key"
FRONTEND_URL="https://your-frontend-domain.com"
```

### Docker (Optional)

```dockerfile
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY . .
RUN npx prisma generate
EXPOSE 5000
CMD ["npm", "start"]
```

## ğŸ“ Scripts

```bash
# Development
npm run dev          # Cháº¡y vá»›i nodemon

# Production
npm start            # Cháº¡y production

# Database
npm run seed         # Cháº¡y seed data
npx prisma studio    # Má»Ÿ Prisma Studio
npx prisma migrate dev # Cháº¡y migration
```

## ğŸ”§ Troubleshooting

### Lá»—i ThÆ°á»ng Gáº·p

1. **Database Connection Failed**
   - Kiá»ƒm tra DATABASE_URL trong .env
   - Äáº£m báº£o MySQL Ä‘ang cháº¡y
   - Kiá»ƒm tra credentials

2. **JWT Token Invalid**
   - Kiá»ƒm tra JWT_SECRET trong .env
   - Äáº£m báº£o token chÆ°a háº¿t háº¡n
   - Kiá»ƒm tra format Authorization header

3. **Rate Limit Exceeded**
   - Äá»£i 15 phÃºt hoáº·c tÄƒng limit trong config
   - Kiá»ƒm tra IP cÃ³ bá»‹ block khÃ´ng

## ï¿½ï¿½ Performance

### Optimizations
- **Connection Pooling** - Prisma connection pool
- **Rate Limiting** - Báº£o vá»‡ server
- **Input Validation** - Giáº£m lá»—i processing
- **Error Handling** - Graceful error responses

### Monitoring
- **Health Check** - `/api/health`
- **Database Status** - `/api/test-db`
- **Logging** - Console logs vá»›i timestamps

## ğŸ¤ Contributing

1. Fork repository
2. Táº¡o feature branch
3. Commit changes
4. Push to branch
5. Táº¡o Pull Request

## ğŸ“„ License

ISC License

## ğŸ‘¥ Team

- **Backend Developer** - Authentication & API
- **Database Designer** - Schema & Relations
- **Security Engineer** - JWT & Validation

---

## ğŸ“ Support

Náº¿u gáº·p váº¥n Ä‘á», vui lÃ²ng táº¡o issue hoáº·c liÃªn há»‡ team development.

**Last Updated**: 2025-09-12
**Version**: 1.0.0
**Status**: âœ… Production Ready