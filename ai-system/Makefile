# E-commerce AI System Makefile (No OpenAI Required)

.PHONY: help install setup dev build start train api save-api test clean import-shopee train-all deploy

# Default target
help:
	@echo "ğŸš€ AI E-commerce System (No OpenAI Required)"
	@echo "=============================================="
	@echo ""
	@echo "ğŸ“¦ Setup Commands:"
	@echo "  setup          - Complete system setup"
	@echo "  install        - Install dependencies"
	@echo "  import-shopee  - Import Shopee reviews data"
	@echo ""
	@echo "ğŸ¤– AI Model Commands:"
	@echo "  train-all      - Train all AI models"
	@echo "  train-sentiment- Train sentiment analysis model"
	@echo "  train-business - Train business analytics model"
	@echo "  setup-chatbot  - Setup chatbot with RAG"
	@echo ""
	@echo "ğŸ’¬ Chatbot Commands:"
	@echo "  chatbot-chat   - Interactive chatbot chat"
	@echo "  chatbot-demo   - Demo chatbot capabilities"
	@echo "  chatbot-api     - Start chatbot API server"
	@echo ""
	@echo "ğŸ“Š Data & Improvement Commands:"
	@echo "  generate-sample - Generate sample furniture reviews data"
	@echo "  process-crawled- Process crawled data for training"
	@echo "  improve-sentiment- Complete improvement pipeline"
	@echo ""
	@echo "ğŸš€ Massive Data Commands:"
	@echo "  crawl-massive   - Crawl 1000-2000 reviews from multiple sources"
	@echo "  process-massive- Process massive data for training"
	@echo "  improve-massive- Complete massive improvement pipeline"
	@echo ""
	@echo "ğŸš€ Server Commands:"
	@echo "  start          - Start AI System Server"
	@echo "  dev            - Start development server"
	@echo "  prod           - Start production server"
	@echo ""
	@echo "ğŸ§ª Testing Commands:"
	@echo "  test           - Run all tests"
	@echo "  test-system    - Test complete system"
	@echo "  sentiment-chat - Interactive sentiment analysis chat"
	@echo "  quick-test     - Quick sentiment test (usage: make quick-test TEXT=\"your text\")"
	@echo ""
	@echo "ğŸ§¹ Maintenance Commands:"
	@echo "  clean          - Clean build files"
	@echo "  deploy         - Deploy to production"
	@echo ""

# Complete system setup
setup:
	@echo "ğŸš€ Setting up complete AI system..."
	python scripts/setup_ai_system.py
	@echo "âœ… System setup completed"

# Install dependencies
install:
	@echo "ğŸ“¦ Installing dependencies..."
	npm install
	pip install -r requirements_core.txt
	pip install -r requirements_sentiment.txt
	pip install -r requirements_business.txt
	pip install -r requirements_chatbot.txt
	pip install -r requirements_api.txt
	pip install -r requirements.txt
	@echo "âœ… Dependencies installed"

# Development server (labeling tool)
dev:
	@echo "ğŸš€ Starting development server..."
	npm run dev

# Build production
build:
	@echo "ğŸ”¨ Building production version..."
	npm run build
	@echo "âœ… Build completed"

# Start production server
start:
	@echo "ğŸš€ Starting production server..."
	npm start

# Train all AI models
train-all:
	@echo "ğŸ¤– Training all AI models..."
	python scripts/train_sentiment_model.py
	python scripts/train_business_model.py
	python scripts/setup_chatbot.py
	@echo "âœ… All models trained"

# Train sentiment analysis model
train-sentiment:
	@echo "ğŸ“Š Training sentiment analysis model..."
	python scripts/train_sentiment_model.py
	@echo "âœ… Sentiment model trained"

# Train Shopee sentiment model (recommended)
train-shopee-sentiment:
	@echo "ğŸ“Š Training Shopee sentiment model..."
	python scripts/train_shopee_sentiment.py
	@echo "âœ… Shopee sentiment model trained"

# Test Shopee sentiment model
test-shopee-sentiment:
	@echo "ğŸ§ª Testing Shopee sentiment model..."
	python scripts/test_shopee_sentiment.py
	@echo "âœ… Shopee sentiment model tested"

# Train advanced Vietnamese sentiment model
train-advanced-sentiment:
	@echo "ğŸš€ Training advanced Vietnamese sentiment model..."
	python scripts/train_advanced_sentiment.py $(DATA_DIR)
	@echo "âœ… Advanced sentiment model trained"

# Generate sample furniture reviews data
generate-sample:
	@echo "ğŸ“ Generating sample furniture reviews data..."
	python scripts/generate_sample_data.py
	@echo "âœ… Sample data generated"

# Crawl furniture reviews data (manual run)
crawl-reviews:
	@echo "ğŸ•·ï¸ Crawling furniture reviews data..."
	@echo "âš ï¸ Note: This may take time and requires internet connection"
	python scripts/crawl_furniture_reviews.py
	@echo "âœ… Reviews crawling completed"

# Process crawled data
process-crawled:
	@echo "ğŸ”§ Processing crawled data..."
	python scripts/process_crawled_data.py
	@echo "âœ… Crawled data processed"

# Improve sentiment model (crawl + process + train)
improve-sentiment:
	@echo "ğŸš€ Improving sentiment model with new data..."
	python scripts/improve_sentiment_model.py
	@echo "âœ… Sentiment model improved"

# Crawl massive reviews data (1000-2000 reviews)
crawl-massive:
	@echo "ğŸ•·ï¸ Crawling massive reviews data..."
	@echo "âš ï¸ Note: This will generate 1000-2000 reviews from multiple sources"
	python scripts/data_crawling/crawl_massive_reviews.py
	@echo "âœ… Massive reviews crawling completed"

# Process massive data
process-massive:
	@echo "ğŸ”§ Processing massive data..."
	python scripts/data_crawling/process_massive_data.py
	@echo "âœ… Massive data processed"

# Improve sentiment model with massive data
improve-massive:
	@echo "ğŸš€ Improving sentiment model with massive data..."
	@echo "Step 1: Crawling massive data..."
	python scripts/data_crawling/crawl_massive_reviews.py
	@echo "Step 2: Processing massive data..."
	python scripts/data_crawling/process_massive_data.py
	@echo "Step 3: Retraining model..."
	python scripts/sentiment/train_advanced_sentiment.py /Users/macbookpro/Workspace/test_repo/shopee-reviews-sentiment-analysis/data
	@echo "âœ… Massive sentiment model improved"

# Train business analytics model
train-business:
	@echo "ğŸ“ˆ Training business analytics model..."
	python scripts/business_analytics/train_business_model.py
	@echo "âœ… Business model trained"

# Setup chatbot with RAG
setup-chatbot:
	@echo "ğŸ¤– Setting up chatbot with RAG..."
	python scripts/chatbot/setup_chatbot.py
	@echo "âœ… Chatbot setup completed"

# Interactive chatbot chat
chatbot-chat:
	@echo "ğŸ’¬ Starting interactive chatbot..."
	python scripts/chatbot/chatbot_interactive.py

# Demo chatbot capabilities
chatbot-demo:
	@echo "ğŸ¯ Demo chatbot capabilities..."
	python scripts/chatbot/chatbot_demo.py

# Production AI Server
start:
	@echo "ğŸš€ Starting AI System Server..."
	python main.py

# Development server
dev:
	@echo "ğŸ”§ Starting AI System Server (Development)..."
	python main.py --debug

# Production server
prod:
	@echo "ğŸ­ Starting AI System Server (Production)..."
	python main.py --host 0.0.0.0 --port 5002

# Legacy compatibility
ai-api: start
chatbot-api: start

# Train AI models from labeled data (legacy)
train:
	@echo "ğŸ¤– Training AI models from labeled data..."
	python scripts/train_models.py
	@echo "âœ… Training completed"

# Start integrated AI API server
api:
	@echo "ğŸš€ Starting integrated AI API server..."
	python scripts/start_api_server.py

# Start Save Labels API server
save-api:
	@echo "ğŸš€ Starting Save Labels API server..."
	python api/save_labels_api.py

# Import Shopee reviews data
import-shopee:
	@echo "ğŸ“¥ Importing Shopee reviews data..."
	python scripts/import_shopee_data.py
	@echo "âœ… Shopee data import completed"

# Run all tests
test:
	@echo "ğŸ§ª Running all tests..."
	python -m pytest tests/ -v
	python scripts/test_system.py
	@echo "âœ… All tests completed"

# Test complete system
test-system:
	@echo "ğŸ§ª Testing complete AI system..."
	python scripts/test_system.py
	@echo "âœ… System test completed"

# Interactive sentiment analysis chat
sentiment-chat:
	@echo "ğŸ’¬ Starting interactive sentiment analysis chat..."
	python scripts/sentiment_chat.py

# Quick sentiment test
quick-test:
	@echo "âš¡ Quick sentiment test..."
	python scripts/quick_sentiment_test.py $(TEXT)

# Deploy to production
deploy:
	@echo "ğŸš€ Deploying to production..."
	@echo "1. Building production version..."
	npm run build
	@echo "2. Training final models..."
	make train-all
	@echo "3. Starting production server..."
	nohup python scripts/start_api_server.py > logs/api.log 2>&1 &
	@echo "âœ… Deployment completed"

# Clean build files
clean:
	@echo "ğŸ§¹ Cleaning build files..."
	rm -rf out/
	rm -rf node_modules/
	rm -rf .next/
	rm -rf models/*.pkl
	@echo "âœ… Clean completed"

# Full setup
setup: install
	@echo "ğŸ”§ Setting up AI system..."
	mkdir -p models data logs
	cp env.example .env
	@echo "âœ… Setup completed"
	@echo "ğŸ“ Please edit .env file with your database configuration"
